# 定期的な自動チェック設定ガイド

## Windowsタスクスケジューラでの設定方法

### 1. タスクスケジューラを開く

1. Windowsキー + R を押す
2. `taskschd.msc` と入力してEnter
3. タスクスケジューラが開きます

### 2. 基本タスクの作成

1. 右側の「基本タスクの作成」をクリック
2. 名前: `プロキシチェック`（任意の名前）
3. 説明: `定期的にプロキシの有効性をチェック`（任意）
4. 「次へ」をクリック

### 3. トリガーの設定

1. タスクの開始時期を選択:
   - **毎日**: 毎日指定時刻に実行
   - **毎週**: 毎週指定曜日の指定時刻に実行
   - **毎月**: 毎月指定日の指定時刻に実行
2. 「次へ」をクリック
3. 開始日時を設定（例: 毎日 午前9時）
4. 「次へ」をクリック

### 4. 操作の設定

1. 「プログラムの開始」を選択
2. 「次へ」をクリック
3. **プログラム/スクリプト**: `schedule_check.bat` のフルパスを入力
   - 例: `C:\dev\proxy_check\schedule_check.bat`
4. **開始場所**: プロジェクトフォルダのパスを入力
   - 例: `C:\dev\proxy_check`
5. 「次へ」をクリック

### 5. 完了

1. 設定を確認
2. 「完了」をクリック

### 6. 詳細設定（オプション）

タスクを右クリック → 「プロパティ」で以下を設定できます:

- **全般タブ**:
  - 「ユーザーがログオンしているかどうかにかかわらず実行する」にチェック
  - 「最上位の特権で実行する」にチェック（必要に応じて）

- **条件タブ**:
  - 「タスクを実行するためにコンピューターをAC電源に接続する」のチェックを外す（ノートPCの場合）

- **設定タブ**:
  - 「タスクをスケジュールどおりに実行できなかった場合、できるだけ早く実行する」にチェック

## ログの確認

- **通常ログ**: `schedule_log.txt` に記録されます
- **エラーログ**: 無効になったプロキシが検出された場合、`schedule_error_log.txt` に記録されます

## 手動実行

バッチファイルを直接実行してテストできます:

**コマンドプロンプト (cmd) の場合:**
```bash
schedule_check.bat
```

**PowerShell の場合:**
```powershell
.\schedule_check.bat
```

または:
```powershell
cmd /c schedule_check.bat
```

## 注意事項

- PythonがPATHに登録されている必要があります
- `config.json` が正しく設定されている必要があります
- スプレッドシートへのアクセス権限が必要です
